<div ng-controller="TaskRunsContoller">
    <div layout="row">
        <div flex id="taskrunsets">
            <div id="task_filter" layout="row">
                <md-input-container flex-gt-sm>
                    <label>Owner</label>
                    <md-select ng-model="params.contestant" id="owner-filter">
                        <md-option value="">All owners</md-option>
                    </md-select>
                </md-input-container>
                <md-input-container flex-gt-sm>
                    <label>State</label>
                    <md-select ng-model="params.node" id="state-filter">
                        <md-option value="all">All</md-option>
                        <md-option value="finished">Finished</md-option>
                        <md-option value="running">Running</md-option>
                        <md-option value="waiting">Waiting</md-option>
                    </md-select>
                </md-input-container>
                <md-input-container flex-gt-sm>
                    <label>TaskRunSet ID</label>
                    <input ng-model="params.run_set" placeholder="TaskRunSet ID"
                           ng-model-options="{updateOn: 'blur'}">
                </md-input-container>
            </div>
            <div class="md-toolbar-tools">
                <span>{{selected.length}} {{selected.length > 1 ? 'Task Runs' : 'Task Run'}} selected</span>
            </div>
            <md-table-container>
                <table md-table md-row-select="true" multiple ng-model="selected" md-progress="promise">
                    <thead md-head>
                    <tr md-row>
                        <th md-column>Rendered Code</th>
                        <th md-column>Is Local?</th>
                        <th md-column>IP</th>
                        <th md-column>Created at</th>
                        <th md-column>Actions</th>
                    </tr>
                    </thead>
                    <tbody md-body>
                    <tr class="na-tr" md-row md-select="result" md-select-id="id" ng-repeat="result in results">
                        <td md-cell><code>{{ result.rendered_code.length>10 ? result.rendered_code.substr(0, 10) +
                            '...' : result.rendered_code }}</code></td>
                        <td md-cell>
                            <md-icon aria-label="backup"
                                     class="material-icons step">{{ result.is_local ? 'done' : 'clear'}}
                            </md-icon>
                        </td>
                        <td md-cell><code>{{ result.node.ip }}</code></td>
                        <td md-cell>{{ result.created_at | date:'M/d/y, HH:mm:ss' }}</td>
                        <td>
                            <md-button class="md-fab md-mini" aria-label="Stop" ng-click="changeHovered(result)">
                                <md-icon aria-label="backup"
                                         class="material-icons step">visibility
                                </md-icon>
                            </md-button>
                            <md-button class="md-fab md-mini" aria-label="Stop">
                                <md-icon aria-label="backup"
                                         class="material-icons step">pause
                                </md-icon>
                            </md-button>
                            <md-button class="md-fab md-mini" aria-label="Stop">
                                <md-icon aria-label="backup"
                                         class="material-icons step">more_horiz
                                </md-icon>
                            </md-button>

                        </td>
                    </tr>
                    </tbody>
                </table>
            </md-table-container>

            <br>
            <div layout="row">
                <md-button ng-disabled="!pagination.previous_url"
                           aria-label="previous"
                           class="md-icon-button md-raised"
                           ng-click="prevPage()"
                           aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </md-button>
                <md-button ng-repeat="page in pagination.page_links"
                           aria-label="page_number"
                           ng-disabled="page[3]"
                           class="md-icon-button"
                           ng-class="{'md-accent md-raised':page[2]==true}"
                           ng-click="setPage(page[1])">
                    <span ng-if="page[3]" aria-hidden="true">&hellip;</span>
                    <span ng-if="!page[3]">{{ page[1] }}</span>
                </md-button>
                <md-button ng-disabled="!pagination.next_url"
                           aria-label="next"
                           class="md-icon-button md-raised"
                           ng-click="nextPage()"
                           aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </md-button>
            </div>
        </div>
        <div flex class="flex-35" id="details">
            <md-card>
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Rendered Code</span>
                        <span class="md-subhead">
                            <code>
                                {{ hovered.rendered_code }}
                            </code>
                        </span>
                    </md-card-title-text>
                </md-card-title>
            </md-card>
            <md-card>
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Node</span>
                        <span class="md-subhead">
                            <code>
                                IP address :
                                {{ hovered.node.ip }}
                            </code>
                        </span>
                        <span class="md-subhead">
                            <code>
                                MAC address :
                                {{ hovered.node.ip }}
                            </code>
                        </span>
                        <span class="md-subhead">
                            <code>
                                Username :
                                {{ hovered.node.username }}
                            </code>
                        </span>
                        <span class="md-subhead">
                            <code>
                                Connected :
                                <md-icon aria-label="backup"
                                         class="material-icons step">{{ hovered.node.connected ? 'done' : 'clear'}}
                                </md-icon>
                            </code>
                        </span>
                    </md-card-title-text>
                </md-card-title>
            </md-card>
            <md-card>
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Contestant</span>
                        <span class="md-subhead">
                            <code>
                                Name:
                                {{ hovered.contestant.name }}
                            </code>
                        </span>
                        <span class="md-subhead">
                            <code>
                                Country:
                                {{ hovered.contestant.country }}
                            </code>
                        </span>
                        <span class="md-subhead">
                            <code>
                                Number:
                                {{ hovered.contestant.number }}
                            </code>
                        </span>
                    </md-card-title-text>
                </md-card-title>
            </md-card>
        </div>
    </div>
</div>